EXAMPLE = """???.### 1,1,3
.??..??...?##. 1,1,3
?#?#?#?#?#?#?#? 1,3,1,6
????.#...#... 4,1,1
????.######..#####. 1,6,5
?###???????? 3,2,1"""

RIDDLE = """???#...#.?#??#?#? 1,1,1,8
#?.???????#????#???. 1,1,12
????.#??##??? 1,2,3
??#.#????#???#.??. 2,10,1
??????.?.???##?#?. 6,1,7
?#????????????###?? 1,3,9,1
?.??#?#?#.???? 7,1
.????????..??.#?. 5,2,2
.?.??#???.. 1,1,1
???#?????????#?? 2,1,3,2
??#?#?????. 4,2
?####???.???#? 6,1,2
#?.?#?#?????.?#.?.? 1,5,2,1,1,1
??.##?#?##??.??? 1,7,1
???.###?#?# 1,7
?????##?#..#? 1,3,1,1
??#??#?.???.?#??#? 1,1,1,2,1,2
?#?#?.???.?? 4,1,1
.?#?????#?? 3,1,2
?#??????????.??? 3,7,1
???????##??###???#?? 2,3,5,4
?.???#.??? 1,1,1
???.#?#?????.?#???#? 2,5,1,3,3
?.#?.#????.??## 1,2,1,3
?????????##?#??????? 1,5,9,1
?###????#??##?#... 9,4
????.#?#????..???. 5,1
????#??.##??#?#??.?? 1,2,5,3
..?????#.???.??##? 1,1,2,1,3
?#?????#??##.??# 12,1
?#??#?#.#????? 1,4,2,2
???#?...???????.? 3,2,4
??#??#?#?#?????#?.#. 1,1,12,1
???#??..?###. 5,4
?#.??#?#????????# 2,2,1,7
????.?????. 1,2,1
?.??????#??.???#.?? 1,1,2,1,4,1
???#??????.??????. 6,1,1,1,1,1
?#??#?#??##??? 1,4,5
?..??#??????.??. 1,4,1,1,2
?.??##???..??? 1,3,1,1
?##???.????#?? 3,3
??????.??#????? 1,1,5
?##.????#????.#??. 2,8,1
????#????#??# 1,10
???.?#??????#???.? 1,2,1,1,1,2
.?###.##??? 4,2
??.????#???#???###.? 1,15,1
?#????#?#???. 3,1,1,4
???????.????#???? 6,4
..??..???# 2,1
.?.?#?????..????..? 1,4,1,1,2,1
?#?.?.???????? 3,1,1,5
?###?.??#??.?###?# 4,3,6
..?#?.??#??##? 3,2,2
.?????#?????#?##?? 1,3,2,5
?#???#??.?.#?????? 8,2,3
??.??????#?#???? 1,2,5,1
?.??????#? 1,3,1
?...#??.?????#? 1,3,6
?.??.?..?#???? 1,1,1,4
.#??????.? 1,1
?????..?#????#.? 1,2,2,4,1
#.###?#????. 1,5,1,1
.???????#.???#?. 1,1,3,1,1
?#?#?.???????. 4,2
#????????#? 8,1
#?.?#????????? 1,2,6
?#??#????##?.???.? 5,1,3,2,1
????#????#???#?.???? 1,10,1,4
?##??????.???#?..?? 9,1,2,1
?#.??#???.. 1,1,2
.?#?????#.? 3,3,1
??.????.#??? 1,2
#??#??.????#??.?.??? 1,1,1,7,1,1
##????.???. 2,2
??##?.?##? 3,3
?#?..?.??..??.?? 1,1
?#????????? 3,1,2
?##??.???.?.?# 3,1,1,2
?.####???????? 1,4,1,1
?..#.???#????? 1,7
?.??.??##???? 1,1,4,1
.#?#?????#?.#??# 1,1,1,1,4
??.?????#????.??##. 8,4
????????.??.##? 1,1,2,1,3
??##???#???#?#??.? 6,1,3
?..??#???#??. 1,8
????????#????#??#??. 2,11,1
?.???????????#?#. 1,3,1,1,4
?#?#.??#.???#???##?? 1,1,2,11
??#?#???#?#??????? 11,1
.#.??#?????#? 1,6,1
..?????????#?. 3,2
????.??.#.?#?#?????. 1,2,1,1,4,2
#??????????##?.??? 5,1,1,3,1,1
????????..???? 3,2,3
??.????#??#???# 1,7,1
..??#.?????????? 1,5
?#?#???#??#??##?#??? 1,3,1,2,8
?????#.?#???.???# 2,1,4,1,1
?.?#??.??.????#??#? 1,8
??#??.?????? 3,3
?#?..??.?#? 2,1,3
.????##???. 1,6
???...?.????##?? 2,7
???..?###?#? 3,6
??.?#?#??###?????#? 1,4,8,1
.????#??#?# 1,6,1
?????.??.? 1,2
?#???##??.?..### 1,5,1,3
.???#???#??. 4,3
???#?.?#????. 1,5
?????..??.#?#?###??# 1,2,1,10
????#??????.?#?..#?? 5,2,1,3,2
#????#???????#???#.? 6,10,1
????#??????.?.?..?. 9,1
.??????##????.???#.? 2,8,2,1
.??##?.???#?# 1,3,1,3
????##??##??#?#. 1,11,1
???#?##.?.??? 4,1
?????#?#??? 1,6
?...????????.? 1,2
#??????##??..??? 2,1,4,1
.????????#??. 3,1,1
??#??????##..?.????? 3,6,3
??###??.??###?. 6,5
???.???#???.#?.?? 1,6,1,1
?????#??????? 1,6
.#??#?#?#??.??? 2,7,1,1
#??..??????#? 1,1,1,5
?#..?##??#?. 1,7
?#?#?#??..?.?. 7,1,1
.????????????.?##??? 1,1,8,6
??????####?..# 2,6,1
?????#???#???????? 10,1,1
??#??#???.??#??? 3,1,2,1,3
.#..?.?.?###??#...# 1,1,1,6,1
?#?#???.#??#????..? 1,3,4,1,1
.?##???#????#???? 3,2,4,1
###?..#??#??? 4,1,1,1
???.??#??#??. 1,7
????#?##??? 1,1,5
?.????????????##? 1,1,3,1,4
??#????#??. 1,4,1
.??#???#?.???#???#?? 8,6
##???#??.???#?.?? 6,1,1,1,2
#?#??#???#? 3,2,3
??#??????#??#?? 2,6,1
?.????#?#..??????.?? 6,2
.??.??.#?#?##? 1,1,1,4
????...?????????? 3,5
??#####.###???.?? 7,3,2
?##.??#??#???#??? 2,11
??????.??.?.???? 3,1,1,1,1
?.##?????##?? 2,4
?.???#?????.??????? 1,5,1,1,1,1
?????????#??? 2,9
?#???#?.#?.???.# 2,1,2,1,1
?#??????#?#? 1,1,1,3
?#??????#??.#????? 9,1,1,1,1
#???.?.?#????#???# 4,1,2,5,1
??#??????? 1,6
?????.?#?? 1,1,2
?????##.?.?# 1,3,1,1
???#?????#??# 1,2,2,4
.?#??????..?# 4,1,1
.#???.?.??##.???? 3,1,4,4
???.???#.????.#????? 3,5
#??#??#... 4,1
??.??#??#..???.?? 5,1
??.?#?????..##????? 1,6,2,1,1
..?#??#???????#?#? 8,5
?.??#??.?.??????. 3,6
.#??###???????##??. 1,6,5
??????#???#? 1,3,1,1
??#.?##?.?? 1,1,4
.??#???.?#????.?. 6,2,1,1
.??????#??#?? 6,2
#.?#??##?.??? 1,6,1
.?.##?????. 1,2,1
.?#?.????# 2,5
.????#?.#? 1,2,1
?.???.####???#.?. 1,8
?.#?????.??.???#?? 1,1,1,1,1,6
??#.?#???##??#. 3,9
??.#???????.???#???? 1,1,1,1,2,4
??.???????##? 2,2,3,2
.?.??#..??.. 1,1,1,2
????#?.???###?#???# 4,1,6,1,1
????#??????...???? 4,3,1
#?.#?.?????#??? 2,1,1,4
.????????#???#??.?#? 2,2,8,1
?????.##?? 2,3
##??.##???? 2,4
?????#??#?#?.#??.?? 10,3,2
?????..??????#?. 4,3,4
..?#.?#?#???. 1,5
..?.?##??? 1,2,2
#??#???##?? 1,3,3
??.#?????.????. 1,2
?##?????#?? 6,1,1
????#??###? 3,4
??????#???????#? 6,5,2
?#.??.?#?.#????#.? 1,1,2,1,4
?????#?#?###???##?? 1,5,3,6
#???#?#?#??????.?? 10,2
?.??#???.#.?#?.?#?? 1,5,1,2,3
?#??##?#.????.. 7,3
??#..??.?#?? 3,2,1
???#??.???.?? 5,1,1,1
??.??#.?#.??.??? 1,2,2,1,1
??.#???#?. 1,2,1
??.??##???. 1,5
?##?#????#??.???.# 3,1,5,1,1
??###?###?#????.???? 1,13,1,1
.???.??##.? 1,4
??????.??###??????? 2,5,5
.#?#?#???#?? 1,7
????#?#..#??.? 3,1,1,1
??#?.##?##?###???? 1,11
.?.#??????##???? 1,1,1,4,1
#??.##??#???#?#???#? 1,15
?????#???#?#?.? 1,8
?#???##??..?## 7,3
????????#? 1,4
##????#???????? 2,4,1,2
?#?##.?###??..?.? 4,4,1
??##???##?.??? 8,2
.???????#.?##??### 7,8
#????????????.##?? 6,1,2,3
?.??????#?????..#? 1,2,1,1,1,2
????#??..?.#???#???? 6,1,1,2,2
.??????#?.?#??.? 3,2,2
?????.??##? 3,1,4
.?.???##.##?### 5,6
?##?????##???#?.?.#? 3,1,8,1,2
????.?##.?? 3,2
?.??.??.??#?###??? 1,1,1,1,6
?.??????#?# 2,3
??#?#?.?????# 6,1,1,1
?.#?#??#?? 1,2,2
??????.#???# 2,1,3
?.#..???#. 1,1,1
#???.????? 4,1
??#?????##???.??? 10,2
??.??#.??? 1,1,1
??..???????#??? 1,1,1,1,2
#??.????#?? 1,2,1
.#?.#???.?.? 1,1,1,1
??????.##?#?. 3,5
?##???????.?##??#?? 3,2,1,8
??#?????.?#?#. 4,4
.???????#??#???.?# 12,1
.#??????.??#?.? 3,2,2,1
?????#????.??#???.?? 10,5
??.#..??#? 1,1,2
?????#?.??#? 2,2,2
?.#???.#????..??#? 1,1,1,2,2,2
?##??..#.#?.?#. 4,1,1,1
?????#.??.#??? 1,1,1,3
??????#??.???##??.?. 8,5
?#????#??????.??? 3,2,2,1
#??????????##..??.?? 1,1,1,5,1,1
##??#????????..?.?.? 13,1
.????.#??#??.?#??# 1,1,1,3,2,1
.?##??#????...?????. 10,5
##.???????????.#??? 2,1,6,1,2,1
.??#??#?.?#???? 3,1,4
.???.??????## 1,2,3
????????#??#?#?. 5,7
???.??#??#?. 2,2,1
..??????##. 3,2
??????#????????? 1,5,1
##?#???###?#?.. 10,2
???..???##?.?#..?? 2,1,3,1,2
?????##??? 1,5
?.????#?.??#? 1,5,4
..????#??.?.#?? 1,4,1
#????#?.?.. 6,1
.?.#??.?#???#???? 2,5
.?#..??.????? 2,2,2,2
???.??#????.?.??#??# 1,4,1,6
.#???????..#????? 5,5
##???.??#?? 2,1,5
?##?????#??? 5,1,3
??.#.#?????#??? 1,1,1,1,3
??.??.?#?? 1,1,4
?????.?#?? 1,3
????#?#????? 1,8
????????#?### 5,5
.??.?.??#?? 1,1,1
????????#???#?. 3,3,2,2
??.#???..?.?.?. 3,1
???????#.?????? 5,5
.???#?.????. 4,1,1
.??#??#??.?# 4,1,1
.????..?.?? 3,1,2
#??#?#?#####.?? 2,1,7,1
.?#??#???.? 2,1,2
#???#?#??#??.? 1,2,1,3
?#?#.???#? 1,1,4
??.????#?..??.?.?#? 1,1,4,2,1,2
#??????#??.???##??. 2,7,1,5
?#???.#.?????#?#? 4,1,6
###???.??..###?#?.? 5,2,6
??#?#??##?????# 1,1,5,4
.##??######???#?? 3,7,2,1
?#.?????.#?#?#???? 1,4,7
??.?#???##?????#. 1,3,6,1
??????#???????#??. 1,2,1,2,3
.???.?#?????.?.? 1,3,1,1,1
?.##??????? 1,3,2
..????.??? 1,1
..??#?.??? 4,1,1
?##???#.#? 3,2,2
???#?????.#???? 2,1,1,3,1
.??.?????..# 2,1,1,1
.????????#??? 1,3
??.???#??????? 2,4,3
?..?#?????.?##.# 7,3,1
??.?#?#????? 1,9
?#..???#?#??#.? 1,6
?#?#?????.#??. 8,2
??????????. 1,4
.?#????#?.#?## 2,1,1,4
#?#?###????.???????. 11,1,1
.#??####.?#??? 7,4
.???.#???#?###?? 2,1,1,4
#??????#?? 2,1,3
?.?.##?#?.?..#? 1,2,1,1,1
???#?#???. 4,4
?.???.??#??? 1,1,3,1
???????..## 2,1,2
?.???????.?? 1,1,5,1
#???????.?#?#??##?? 3,1,1,6
?.??.?.???. 2,2
#??##???#??.??. 5,2,1
????????#? 3,1,1
.?????#??##?.#?##??. 8,5
..??..????#?? 1,5
?????#.?#???##??? 1,1,2,8
???#....?# 1,2
?.??????#??#?????? 1,1,7,2,1
?##?.#??.. 2,2
?.?.?..??#?#??? 1,1,1,4,1
.##?.#.#??#??. 2,1,1,2
.????????#?? 2,2,3
?..#????.????#?#?#. 1,1,3,3,3,1
?.#?.?????#???????# 2,12
????##?#????#?#. 12,1
?.?#???????.? 1,2,1,1
##?.????.? 3,2,1
.??#?#???#.??.???? 6,1,2
.???????###?.????. 1,1,5,1,2
..#?????????????? 8,1,1,1
??.#??#?.?# 2,1,1
???????????#????? 2,6
?#.??.???. 1,3
?#???.?.??.??????? 1,1,1,2,6
??????#?????.?? 5,1,2,1
.#???.?.???#? 2,1,3
??##.??.???.??? 3,1,1,2
???.????#??#??##??? 3,1,11
????..##?..?? 3,2
??????????? 1,1,5
???.?#.?.?#?#??????# 3,1,1,8
.??.??#??? 2,6
##?..??????? 3,5
??????#????#.?#???# 1,1,3,1,3,1
?#?????.#?. 3,1,1
?????.??#??##??? 1,1,7,1
.????#??#? 1,4,1
#???#??#????.??? 2,9,2
?#????#??.???.?.? 1,6,1,1,1
????????.#? 2,1,1
???#??##.??#??#?. 7,4
#??.????.??????#? 3,1,1,2,2
?##?#??..?#. 3,1,1,2
.?.?????##???#.?. 3,6
#.?????### 1,2,3
????.??.?# 2,2,1
?????.????.#???#?.? 1,2,2,6,1
????????#?#.????? 4,2,1,1,2
?##????.#? 3,1,2
????.??????? 3,1,1,1
???????#?.? 4,4
.#.??????????. 1,3,4
?????#?.?#.? 2,3,2,1
?#.?????##??.???#? 1,7,1,1,2
#?????.????#?? 1,2,4
???????.????#?? 5,1,2
??.??.##?????.??#?? 1,6,5
???.?????..?##???? 2,6
???????###??##?#? 1,1,12
????????.? 1,1,1
??..???????#? 2,7
??#???.#??##?????? 4,1,5,1,1
.?.???????????#?? 2,5
?????##?.? 1,3
?????.#.??#??#?##?# 3,1,3,6
???.????#? 3,1,1
.??.???.#??.#?##???. 2,3,1,7
..?????###?#???????. 11,2
????????.???????#??# 1,5,3,2,1
??????.##?##?.? 2,5
??.??#???#???.?.? 3,5
?#?#.??#????#.??# 3,2,1,1,1
????#??.##?????.#?. 6,4,1,1
?.?.??.???? 1,2,2
#.?????????#? 1,8
.?????????#??????? 1,3,3,4
???.??????.#.??? 1,1,1,1,3
???.?#?#??? 3,4
????????.???##.??? 1,1,1,1,3,1
??.?.#.?.????.?.? 1,1
???###?##???# 1,6,3
?.?.????##??. 1,1,4
?.????.??.###???? 1,1,1,4,1
?#??????.?????#???. 1,1,8
??????#?.? 1,3
####??#?..#?????# 7,1,2
.????#??.#.???? 1,1,1,2,1
??..#??.?#?##? 3,6
?.??.??##???#????#? 5,7
??????#??.?.??? 3,2,2
?.???..?????#??.. 1,1,8
..?????##?? 2,3
??????.?????#??? 1,1,1,8
????#...?#.?? 1,3,2
??#??.??#??#?? 2,8
#???????..? 1,1,3
?#.??#.?#??# 1,3,5
#???????????###??#?# 2,1,1,1,9
.??##?.?????? 4,5
.????.??.?#. 1,2
#??????????#?..? 2,4,3,1
#?.???###?##????.?? 2,10
??#?..??????. 1,3
#??#?????#?? 1,3,5
??..?#..??.?? 1,2,2,1
?.??.????.# 1,4,1
#????.???? 2,1,2
.????#??#?????#.? 7,2
?.?.??????? 1,3,1
#?#?###??##?#???.#?? 11,2,2
#?..?????#???? 2,2,3
?.??????.????.?# 1,3,1,1,1
??????#?????.? 1,1,3,1
???#????.?#????. 4,1
##?####?#?#?.???? 11,2
??.#?.?.?#?.? 1,1
????#????###?#????? 2,1,11,1
#??#?.?#????#?#????# 4,2,1,5,1
??.???#.??#.#?#?#??# 1,2,1,1,1,8
?#?????????.?? 1,5,1,2
???#????#???#..? 4,1,2,1,1
???..??##?# 1,5
??.?.#?#??#???#?# 1,1,4,3,3
?#??#?##?#???? 5,4,1
????##??#? 4,1
#?.?????.#?.? 2,3,1,1
??.?#????????? 2,4,1,2
??.?.???.?????#? 1,1,2,2
??.????.??? 3,3
??.??????##???? 1,3
?#????.??##? 2,1,3
??#?##??#?#? 1,4,1,1
.?.#???.#.???#??#?? 1,1,1,1,8
???#.??..#??????.?? 3,1,5,1,1
?##??.#?.??.?? 2,2,2
???#?.???.?##?? 4,1,1,2
.?????????#. 3,1,3
???###?.#.#?#?.#? 6,1,4,1
????#???#?? 2,7
??#??#????#?? 7,3
..?.?????? 1,2,1
?#?#??#??. 1,4,1
??##????.? 5,1,1
.???#?##?#??? 1,1,2,4
??#???.?##??. 4,4
??##?#?#???.#?????. 4,1,4,3,1
.????##?????#?? 1,1,2,6
?.##????.#?#?.#?? 1,4,3,1
?????#?#?? 1,6
.#?##??????.?##.??. 6,1,3,1
??#?.?????.?#??.? 3,1,3
.?????###?? 2,4,1
?.?#?#.??...#..?? 1,4,1,1,1
??.????.??????#? 2,4,1,3
.????.?##?#?? 2,3,2
#?#?####?#???.#????? 12,5
??#.?????? 2,3,1
.#???#??#???#?#?..?? 1,1,1,7,1
??#????#???.#? 7,2,1
#?#?#..#???#??? 5,1,2,1
.?#?#####??.? 8,1
???#?#?.??#???.?# 6,3,2
.??#???#??? 1,2,3
???#???#??#? 2,3,1
?????.??????.?.?? 2,3,1,1
.?##????.????? 5,3
##?.#??#?. 3,2,2
???.#?##?#?#??.#?? 2,1,6,1,1
??#????.??????#?#?? 6,5,1
??#?#?...???# 4,1,1
??.?#??.?##.?.#??? 3,3,4
#?#????.??????#?? 7,1,4
.??????#??? 2,5
#?#?..????????????? 4,6,2,1
..#?#????#?? 3,4
#??#?#??????#??#?#? 10,7
?????.?#?#??? 1,6
??###???.???#?.## 6,2,1,2
????#??#?##. 3,1,4
#????#??#?????#?.?? 1,8,2,1,2
#.???#?????.? 1,4,1,1
#?.??.?????#?##.? 1,1,4,4,1
.??.???????? 1,1,1,1
??.?##?????.. 1,6
??#???.???? 1,1,1
.?.?.??##?????#?? 1,1,10,1
?????????????? 9,1
??#.#.??#???? 1,1,5,1
.???????#?#????.?.#? 5,4,2,2
.#??#??#?.? 1,5
?##?#??##??#??#?.??? 15,1
?#?#????????#?.?.# 3,3,2,1,1,1
???#??.?????#??.. 3,6
???#??..???#?.?.??? 1,2
##???#.?.. 3,1,1
??.??#?#?#???##?#?.? 2,1,1,1,9
.#????#?#????#?#?. 9,4
???#?###.##. 1,1,3,2
????#.?..???#?? 1,3
.#.????#???.#??? 1,6,1,1,1
??#.?.?#???.#?..#?. 2,1,2,1,1,2
?#????..?? 2,1
????.?#???#.???? 3,5,3
??????????##.???#.#? 1,3,1,2,4,1
?.?#.????#???##.? 1,8
#?.#????.? 1,3
.#???#.?#?????.?? 1,3,5,1
?.#????##?? 1,3,3
##?.?.#.??????#?? 3,1,1,4,1
????.??.?.????? 1,1,1,1,2
.?#?##.??#???? 4,6
?.?????.?#.. 2,1,1
????.?#??# 1,1,1
#.####??#?.#??# 1,8,1,1
.??.##???? 1,2,1
??..???.#. 2,1,1
?..????.??? 1,2
.??????#...?.????? 1,1
???.??#???##?? 1,3,4
????#??#?#??????##?? 1,5,1,1,5
?#???..???#???#??? 2,6
??????.??##?. 2,3
??#?????##??#.#?#??# 3,7,6
???.?????##?? 1,7
.?#??#?.?.?? 1,1,1,1
??.????#?? 1,2,1
???###.#???? 4,2,1
?.?#????.???????.. 3,1,6
???.??.#?#..??##. 1,1,1,1,4
????#????#.?##? 2,1,2,3
??#?##?#??.??????? 8,3
..#???#????.??? 1,3,1,2
??#?.?.???????.#.?? 3,1,1,5,1,1
?????#??.?? 1,2,1
????????..?#??#??.## 1,1,2,6,2
.#??????##??.?.??.?? 9,1,1,1
??##??#?????. 8,2
#.?.?????? 1,2
.????#?#???#..??# 2,7,3
?.?#?????????.#? 1,1,1,3,1
..#????.?????? 3,1,1,2
??#??#?.????.???.? 3,2,1,1,2
#???#.??.##??# 3,1,5
?.?.?#?##.???? 1,1,4,2
.?###..??#??????## 4,1,4
???#??????#. 2,4
??####????#?.??.. 7,1,1
#?.??????#? 1,2,1
.?##?#????????#?.??? 3,1,1,1,5,3
?.???#?##?.. 2,4
????#???..?##?# 1,1,1,3,1
??#??.#?.?????.? 4,1,4,1
???#.???.??. 4,1,2
?#?#...??#. 2,1,3
????#.?#..??. 1,2,2,2
?.#??#????#?##??? 12,1
??#??????#? 6,3
???.????#??? 1,1,1,2
???#.????.????? 1,2,5
??.?.??#??.??#??? 1,1,5,1,3
??#??????? 2,2
?.??#???????##??? 1,6,3
???#?#?.???#????#?? 7,1,8
.????????????? 3,1,2,1
?????##?#?#??.... 1,8,1
.?##???????#.???. 3,2
???.???????? 1,1,1,1
???#.?????????#?#..? 1,1,1,9,1
?##???#????.??#?#? 10,4
#??.????????? 3,2,1,1
?#?..???#?#?? 3,1,6
?##?#.?##?. 4,4
?#.#?..?#???? 1,2,3,1
??.##??#??#?#? 2,5,4
????##?#???.#.??... 8,1,1
##???????..?.?#??.? 2,4,2
?.?#.?#???. 1,4
.?#.??.????? 1,1,1,1
??????.???.?#?##??.? 2,4
???.????.??#??.?? 1,1,2,4,2
###?#??#.???????? 8,3
???..??#.????. 2,1,1
???.?##???.??????# 2,6,4
.?#?##.?#?????.?? 5,4,1
.??..??.?#? 2,2
.?#??????.##?#? 4,2,2,2
???##.?.?.#???. 2,1,1
?????#???#? 7,1
.#?.???#?.??# 1,3,1,1
?.#?..?#??#####?# 2,10
??#?##???#?#???#?#? 1,8,1,1,1,1
??????#.??#?###. 2,1,6
?#?#?#???#??##???# 1,3,9,1
?#???.????#.??#?#?? 1,1,2,2,3,3
?#?#.#.??.?#??????? 3,1,2,3,1,2
.?#?...?????#.??? 3,4,1,2
?????????#?#?.?# 1,1,1,5,1
##?#?#.???????#?? 6,4
?#??#?????????# 3,1,4,2
???#???#????.?? 1,6,1,1,1
?#.????##?.? 2,6
?.???##??.?#??#? 3,4
??#?????#.?#?. 2,1,1,3
?.?????#?#??#.?.#??? 11,2,1
????#???#?? 1,3,1
???.?#.???.???. 1,1,2,1,1
??????#?..??#? 5,2
.?.?#.?#??. 1,4
?#.??????##????.???? 2,7,1,1,1
?#?#?.?????. 3,1,1
???.##.?.#?. 3,2,1,2
..????????#.####??? 6,5
??#.??..?##?##????#? 1,1,9,1
?#???.??##?.??????. 5,4,3
.?...??#?????#.# 1,7,1,1
??????.?#??.?.? 5,2,1
???..??##?????? 2,5,1
???##?#??????.#.??. 7,2,1,1,1
?????????#?? 1,2,1,1
??.##??.?### 1,2,1,4
??####?#?###..?????? 1,10,1,1,1
??.??#???#??? 1,2,4
????..???#???. 1,6
??????????#? 8,1
#?#.?..????? 1,1,1,2
.?????##???#??? 12,1
##??#?..?#..? 2,2,1,1
###???????. 5,1,1
??.?.##?##??#?.?# 1,1,8,2
???####?.????#?#???# 1,5,10
??.??#???.?????#?#?? 1,1,4,6
???.#??#??..??.?# 2,4,1,2
.?.??##?###.???##? 8,2
.#??.?#.??#?? 3,1,3
????#????#??#??#??? 5,8
#..#???.???#???. 1,1,1,1,3
?.##?????.?#?????. 6,4,1
.????????.??#?? 2,1,1,1,1
.?.????????##?.?.?#? 1,1,5,3
??.#???????## 1,1,1,2
??????#??#???#??#??? 3,1,9,1
??.#??.???#?. 3,4
????.???##. 3,5
#??.??#????? 2,2,1
#?????#??.# 1,6,1
????.??#????.??. 1,7,1
##???????????. 6,1
.??#?????.????#???? 5,1,1,3,1
?????#??#??.?? 1,8
???#..??.???.. 1,2
???#?.#..????#?# 2,1,1,1,1
????.?.??#??#?? 2,1,7
.???#?##????#?? 2,1,4,1
??#?????#?? 4,1
.#????#?###?. 2,7
..????#??? 3,1,1
####???#..??. 6,1
?#???#???##????#?#?. 2,1,10
??#?#?#?.?????# 1,6,1,1,1
?????.##?#?#?#?.??#? 1,2,9,1
.?.????.?. 1,1,1
?????????? 1,3,1
#????#?????? 1,3,3
#.?#..???? 1,1,1
?#?????..????#.?? 1,2,4,1
#?##??????.??. 1,2,3,2
???#??#??. 5,1
?##???.?.??#.?# 3,1,1,1,2
?#?????????? 2,7
??#?#???#?#?????? 2,5,1,1,1
..#?..?.##?.? 2,2,1
???????.???.#?##.?.? 1,4,3,4,1,1
??##??###.# 7,1
?###?#??.#.??..?? 4,3,1,1,2
??????#??#?. 2,2,2
?#?##??????..#?? 6,2,3
?#?#???????..#.#?? 9,1,1,1,1
#?#?#?#????.?? 1,5,2,1
?????#??.?#? 5,1,1
??##???.?#??#.??.? 5,5,1,1
.?#?.?##?? 3,2
.???????#??..?#?? 8,1
?????.???# 4,1
?#?....???..??#? 3,2,1,1
???####?????.???#??? 1,5,1,1,1,1
???.??????...#??? 1,5,3
????#??.???????? 1,1,1,1,3
?#.???.#### 1,3,4
?.?#???#?#?#???.? 1,10,1
???.??#.?.? 2,1
??.??.??????.??.?? 1,1,3,1,1,1
.#??.?#????.#?###? 3,4,1,1,3
#?.???#?.?. 1,2,1
???#???.?? 4,2
????.#?#?#.?#####?# 3,1,3,6,1
..??????##?#?????#?? 2,1,5,2,4
#??.??#????#???#???? 1,15
???????????.? 1,5,1
?#??#???#?? 5,3
.???##????.?????.#. 1,4,1,1,1,1
?.?#?#??.?#?????? 6,2,2
.????????????? 7,1
...?.#???????#? 1,1,2,1
?????.?#?? 2,1
?#.??????? 2,2
#????#???##? 1,6,2
.?#?.?.???#?# 3,1,4
?#??#.??.?#?? 1,1,3
????#.?????#?##.?? 5,1,6,2
???..???????.##?? 2,6,2
..?#???.#?? 2,2
???##?.??#????????. 4,2,2
????#?????.?#??#. 1,5,2,1,2
##.??..#?..?#???? 2,2,1,3,1
??????#???#?#??? 5,7
.?#??.#??#???.#.#? 4,1,1,1,1,1
?.?????#?#?.?? 1,5
?????????#?????#?# 10,2,1,1
??????#??##????#??? 1,5,2,2,2,1
.??#?#????.??### 1,1,1,1,4
?????#?????#????? 4,2,2,1
??.?.?#??????#.??? 1,2,3,1,1
.??.?.???? 2,1,1
.??#????????? 1,2,3
???#?????#??#????#? 1,1,1,5,1,2
?????##???#?? 3,4,1
##?????????# 5,1,1,1
???#??#??????.? 4,1,2
????.??#?#?? 1,1,4
#??????.#???. 1,4,4
????##.??#???#?.??? 3,5
????.?#??#.##???? 1,1,4,2,3
#?#???#??????#. 1,6,2,1
???.???##?#? 1,1,4
?????#.???? 5,3
?#??.????#?????# 1,1,5,3
????#?.?#?.?.?. 1,1,2,1,1
???.???#?#?#??? 1,9
.?##??.??#???#???#? 3,3,6
?????##??.?? 1,6
#????????#####.? 2,1,7,1
#?..??.??#?? 2,1,1,3
?##?#???#???.#??? 5,3,1,1
.?????????????????. 1,1,2,1,1,4
?.???#??.?#?????? 4,5,1
?.????#??#?? 1,1,1,1
??????.#???# 3,1,3,1
#?#??..???##?#?.? 4,6
#??#?.????.?.? 5,1,1
?.?????.??#?#?##??? 1,1,1,10
???#?#.???##???.?.? 1,3,7,1,1
#?#.?#??.??? 3,3,3
.?#???#???.???# 7,3
?#????#??. 3,3
????####?#?.???? 2,5,1,2
?#???#??...??.? 2,2,2
?????????????#?###? 2,11
??.???????###?# 1,4,4,1
????#??.?.???.#???? 6,1,1,1,1,1
??#?#???????? 6,1
#??#?#????#???.? 9,4
?.#?#?#????????#??.? 8,1,3
.?.???#???????????? 1,7,1,2,2
?#???###????.??#?# 1,5,2,5
??#?????.??# 1,2,3,2
?##????.??.?# 4,1,2,1
#.?#?#???? 1,1,5
????.##??.?#??????? 3,4,4,3
?#.??????#??? 1,1,1,3
?#?.#?..??.??? 1,2,1,3
..???????? 3,3
?#????????. 1,3,2
.?#.???#.?? 2,2
?.??????????.?? 3,3,1
?#.??????..?#? 1,4,3
????????.??.#??? 6,2,2,1
?#???????.?????? 2,4,5
???.?#???. 1,1,2
??????#.?##??????#?# 1,5,3,6
??#?????#??.???#??. 4,2,1,5
.?#??.?.?. 2,1
#??#?.#?.#??.???? 5,1,1,1,1
???#????.#.? 2,1
??????#???.#.?#??##? 3,1,5
????#???????.# 9,1,1
????????#?##?#..#?. 1,2,3,2,1,2
??.?##?##.??????#? 2,2,2,4,2
###??#???#??? 3,1,3,1
.?.?.?#?.???#?# 1,1,3,1,1
.?..?#?????.???#??#? 1,2,1,1,2,3
?#.?????????#??#?#?? 2,1,14
?##.#???#?????? 2,1,1,1,1
???#.##???.? 3,5
???????.???#?? 4,1,2
??.#?????#??? 1,10
?#???##???? 2,4,1
?????.????? 3,3
??#?#?#??#????#?#? 2,1,2,1,1,3
#?????????#???????#? 1,3,11
..???#???????.? 2,6
??#???.?#??.? 1,2
..?#.?##?#??.. 2,2,1,1
??.????.?? 1,3,1
?????#?????#.# 1,5,1,1
..?#????#? 2,1
???#????#???.? 1,6,1
?.??#.???#. 2,1,1
..???.??#??. 3,4
???#??##?.???? 5,3,1
.??##?#?.???#?#? 5,7
#.?.???#???? 1,5,1
?????#??.??? 1,3,1
????????####??.##? 3,7,3
???????##???? 1,8,1
???..###??#??#???# 2,3,8
??##????#? 5,1
#??#?#?#?#.#?##.. 10,1,2
##?#?#?????#??? 7,1,2,1
??????????#?##????.? 2,11
##????????.#.?#?# 2,6,1,4
?#?#????#.?### 1,6,3
#?#?#?#..??? 1,1,3,1
???.#?#### 1,6
????????#?.???# 2,4,3
#?????###????.??#?? 12,3
??#.#???#?????.#? 1,5,1,1,1
??#?.???#?????#???? 3,1,5,1,1,1
????#?.????.???? 2,2,2
???#??????????.? 4,7
?.??###???###?#???#? 11,1,1
???????..?? 1,3,2
???#?#?#??#???# 9,1,1
????.????#? 2,4
??#???.?.?.??.?##? 2,1,1,1,1,4
?#.#..???#? 1,1,5
??????????????#???#? 2,3,8
????#?..#?.?##?#? 1,1,1,6
?#.##???..??#?#????# 1,2,2,1,5,2
????#?##?#.? 8,1
..#?#????#? 3,1
???.????.?????## 1,1,1,1,6
#??.????????##??? 1,1,4,4,1
#??#??????. 4,1
??????.???#?????.. 1,1,7
?#.?.????????##??? 1,1,2,2,2,1
????.?##????? 1,1,8
?###?.?#.?##?.# 3,1,2,1
????????.??? 2,3,1
?#?#...##?? 4,2
??#?.#??#.. 1,1,1
#?#.?????.??.. 3,1,2,1
?..?#??.?#? 2,2
#??????#??#?.#???### 4,5,3,3
#??#???????????? 1,2,6,2
?#?????..#?? 4,1,1,1
?.#???#??? 2,2
?#..?.??##???#.?? 1,5,1
???.?.?...?##? 2,1,4
#???.#???#??## 1,1,3,5
.????.?..????.#?? 1,1
??#??.????##?.?.? 1,1,1,4,1
#???.????? 1,1,4
????#.#???.#?? 4,4,2
?#??.#??.##?????..# 1,1,3,2,3,1
???????##???.???.? 2,6,1,1
?.???#?.?.???#???? 4,2
?.??.????. 1,2
#???#???#??????##? 10,2,3
?.??????##???#???? 1,4,10
????#???????.##?##?# 1,2,1,1,7
?????#????#?? 2,5,1
???..?????#??#??.?#. 1,6,3,2
???????#?? 1,3
.??.???.????# 2,3,1,1
????#.#?#####?? 4,8
?#???????????.?. 6,1,1,1
????.?#?##???#????? 2,11
.?.#.??????#??????? 1,1,1,1,7,1
????###.??.. 7,1
???#?.???? 4,1
????.?????#?. 1,6
?##?.????? 3,1,1
?#.?#?#?????.?? 2,7,1
#?#????#?#..????#??# 1,1,5,7
?.##?#????? 4,1
.??#?.###??. 3,4
#??##?????#??#??. 6,6
.#?#?????#?..#? 4,4,1
?.?.??.?#?###? 1,1,1,3
????.?????? 1,4
??????..?.?#?#? 1,1,1,1,4
????##???????#.?.? 5,1,3,1,1
???#??##??##???#???? 12,4
?.??##??#???.?#?. 1,4,2,1,3
???.???#???##???.?. 2,4,5,1,1
?#??..???##???.?? 3,5
?????#????#?.??#.? 1,1,3,3,1
??.????#..??.#?#?#?? 2,7
??##??.????#? 5,2,2
?????????????. 1,1,5
.????.##?# 4,2,1
??.??.?.?? 1,1,1
?#??.???.??.? 2,1,1,2
?.?#?????.?????#? 6,1,1
??##?????#???. 10,1
.?#???????##..#? 1,4,3,1
???#.???.??? 1,1,1,1
?.?#.???..#? 1,2,2,1
?.?#????#??????# 9,2
????#?#?.?##??????? 1,3,2,5,2
?.????##???#??? 1,7,1,1
.?#?.??.##???#??#? 3,2,3,1,1
.#??##????#???#. 6,1,1,2
?????.?.???? 3,1,1
??#??#####??#??.? 2,6,1,1,1
?.?.?#????#?#..? 1,4,4,1
??????..??????#??? 2,5,3
.#?#?#?.??.?#.. 5,2,2
###.??.??????##?# 3,1,9
??.?.####?..? 1,5
????.??.??##. 3,4
#???#??#.???.##??? 1,4,2,4
????.??????. 1,2,2
???#???#??.? 1,3,3,1
????#?#?#?.??? 5,1
#??.??#??????. 1,8
??????#??? 3,2
???##????#?.#?# 1,4,3,1,1
????..????.??#??## 3,1,1,7
???????##???? 2,2,4,1
???.??##?????#.??##. 1,4,1,1,1,2
#.????????????..?? 1,8,1
???..?##???#?? 2,3,3
.?????#..###?. 1,1,4
???.?.???????? 1,1,2,1
????#?#????? 1,1,5
???.?#?#??#?#? 1,2,1,5
.?.???.??#?###??# 1,1,7,2
.???#??.?#??#?? 4,3,2
?#.#??#?..???? 1,1,1,3
#???#????.#??????#. 1,4,1,5,1
..????#??#? 2,1,1
?#...??#??? 1,4
.####?????# 6,1
???#?#??????..#??? 4,3,3
#.???????.????#?? 1,3,1,5
???.???????. 1,7
??#.??#???##??????? 1,10
?????.???.??#??#??# 1,1,1,3,6,1
?.?#???..?# 5,2
??#????##???..?. 3,4,1,1
##?????.###?.? 3,1,4,1
?..#?#??.?????? 1,4,1,1,1
??...#??.??.?. 3,1
.????#?..?#?# 5,3
???#?????????.????.? 11,1,2
.??#???.?#?#????#??. 3,5,3
??#??#.????. 5,2
??????#?.???.?????? 1,2,3,2,1
?##???##?..#??#?? 2,3,4,1
.???#??#????#??????. 7,7
???#?..??# 2,1,1
.?#.???.?????? 2,2,3,1
.#?..#????? 2,2,3"""


def efficient_combinations(lists, target_sum):
    # Generate all combinations, but stop if the partial sum exceeds target_sum
    def generate_combinations(prefix, lists):
        if not lists:
            if sum(prefix) == target_sum:
                yield prefix
            return

        for item in lists[0]:
            new_sum = sum(prefix) + item
            if new_sum > target_sum:
                # If the new sum is greater than target_sum, no need to proceed further
                continue
            else:
                yield from generate_combinations(prefix + [item], lists[1:])

    return generate_combinations([], lists)


def ispossible(string, pattern):
    for s, p in zip(string, pattern):
        if s != p and p != "?":
            return False
    return True


def main():
    riddle = RIDDLE
    answer = 0
    for linenumber, line in enumerate(riddle.splitlines()):
        answeri = 0
        pattern, counts = line.split(" ")
        counts = [int(_) for _ in counts.split(",")]
        pattern = "?".join([pattern] * 5)
        counts = 5 * counts
        len_pattern = len(pattern)
        number_hashtags = sum(counts)
        remaining_space = len_pattern - number_hashtags
        # print(
        #     pattern,
        #     counts,
        #     number_hashtags,
        #     len_pattern,
        #     remaining_space,
        #     pattern.count("?"),
        # )

        lists = (
            [range(0, remaining_space + 1)]
            + [range(1, remaining_space + 1) for _ in range(len(counts) - 1)]
            + [range(0, remaining_space + 1)]
        )

        regexstr = "=" + ">".join(["#" * c for c in counts]) + "="
        print("")
        # print(len(pattern) - len(regexstr))
        print(len(lists), len(pattern) - len(regexstr))
        print(counts)
        print(pattern)
        print(regexstr)

        def nested_loops(list_of_lists, requiredsum, depth=0, current_sum=0, path=[]):
            # Break condition: if the current sum exceeds the required sum
            if current_sum > requiredsum:
                return

            # Base condition: if the depth equals the length of the list of lists
            if depth == len(list_of_lists):
                if current_sum == requiredsum:
                    # print()
                    # print(path)
                    string = "." * path[0]
                    for actual, fillers in zip(counts, path[1:]):
                        string += "#" * actual
                        string += "." * fillers
                    # print(pattern)
                    # print(regexstr)
                    # print(string)
                    possible = ispossible(string, pattern)
                    # print(possible)  # Print the path if the sum equals requiredsum
                return

            # Iterate through elements in the current list
            for element in list_of_lists[depth]:
                nested_loops(
                    list_of_lists,
                    requiredsum,
                    depth + 1,
                    current_sum + element,
                    path + [element],
                )

        nested_loops(lists, remaining_space)

        # for _ in efficient_combinations(lists, remaining_space):
        #     print()
        #     print(_)
        #     string = "." * _[0]
        #     for actual, fillers in zip(counts, _[1:]):
        #         string += "#" * actual
        #         string += "." * fillers
        #     print(pattern)
        #     print(regexstr)
        #     print(string)
        #     possible = ispossible(string, pattern)
        #     answeri += possible

        answer += answeri
        # print(linenumber, answeri)
    # print(answer)


if __name__ == """__main__""":
    main()

    # def nested_loops(list_of_lists, requiredsum, depth=0, current_sum=0, path=[]):
    #     # Break condition: if the current sum exceeds the required sum
    #     if current_sum > requiredsum:
    #         return

    #     # Base condition: if the depth equals the length of the list of lists
    #     if depth == len(list_of_lists):
    #         if current_sum == requiredsum:
    #             print(path)  # Print the path if the sum equals requiredsum
    #         return

    #     # Iterate through elements in the current list
    #     for element in list_of_lists[depth]:
    #         nested_loops(
    #             list_of_lists,
    #             requiredsum,
    #             depth + 1,
    #             current_sum + element,
    #             path + [element],
    #         )

    # # Example usage
    # requiredsum = 4
    # list_of_lists = [[0, 1, 2, 3, 4], [1, 2, 3, 4], [1, 2, 3, 4], [0, 1, 2, 3, 4]]
    # nested_loops(list_of_lists, requiredsum)
